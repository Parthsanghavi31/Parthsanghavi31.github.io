---
layout: page
title: Mask RCNN (Instance segmentation)
description: This is the unofficial implementation of the paper - "Mask R-CNN" by He et. al.   
img: assets/img/MaskRCNN/mask_pred2.png
importance: 5
category: work
github: https://github.com/kausiksivakumar/Instance-segmentation-with-Mask-RCNN
---

Instance segmentation methods provide a way to identify not only object classes but also the number of instances of each object class in the image. Mask-RCNN which segments object masks on each Region of Interest (RoI) in a pixel-to-pixel manner. In this project, Mask-RCNN is implemented from scratch on a subset of [COCO](https://cocodataset.org/#home) dataset. We only segment images to three categories namely humans, animals and vehicles. 

## Region proposal networks (RPN) 
RPNs are attention mechanisms that propose regions in an image that are most likely to contain an object. They estimate bounding box regions in an image. 
<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/MaskRCNN/rpn_ex1.jpeg" title="RPN1" class="img-fluid rounded z-depth-1" %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/MaskRCNN/rpn_ex2.jpeg" title="RPN2" class="img-fluid rounded z-depth-1" %}
    </div>
        <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/MaskRCNN/rpn_ex3.jpeg" title="RPN3" class="img-fluid rounded z-depth-1" %}
    </div>
</div>
<div class="caption">
    Ground truth bounding box (Red) and regions proposed by RPN (Blue)
</div>

We can clearly see that dense bounding box estimates by RPN are around the ground truth bounding box. 

## Box Head
The Box Head refines the proposals from RPN and predicts the objectness scores for the proposals generated by the RPN Head. It also categorizes object proposals into categories - humans, animals, vehicles.

<div class="col">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/MaskRCNN/box_pred1.png" title="Box1" class="img-fluid rounded z-depth-1" %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/MaskRCNN/box_pred2.png" title="Box2" class="img-fluid rounded z-depth-1" %}
    </div>
        <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/MaskRCNN/box_pred3.png" title="Box3" class="img-fluid rounded z-depth-1" %}
    </div>
</div>
<div class="caption">
    Left - Ground truth bounding box, Middle - proposals from Box Head (before refining), Right - refined proposals from BoxHead. Categories - Humans (blue), Animals (Green), and vehicles (Red). 
</div>

## Mask Head
The Mask Head is responsible for further refining box head bounding box predictions to pixel-level segmentation. Thus, the Mask Head takes the box headâ€™s bounding box predictions as well as object class predictions to provide pixel-level segmentation.

<div class="col">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/MaskRCNN/mask_pred1.png" title="Box1" class="img-fluid rounded z-depth-1" %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/MaskRCNN/mask_pred5.png" title="Box2" class="img-fluid rounded z-depth-1" %}
    </div>
        <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/MaskRCNN/mask_pred4.png" title="Box3" class="img-fluid rounded z-depth-1" %}
    </div>
</div>

The final Mask predictions clearly show that the pixel-wise segmentation performed by our MaskHead pipeline is stable and robust to multiple objects of different classes and sizes in the same image.

The code is provided [here](https://github.com/kausiksivakumar/Instance-segmentation-with-Mask-RCNN)